<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "https://raw.githubusercontent.com/rbatis/rbatis/master/rbatis-codegen/mybatis-3-mapper.dtd">
<mapper>
    <select id="select_content">
        select b.`id`,b.`label_id`, b.`content_id` from `label` a left join `link_label` b on a.`id` = b.`label_id` where b.`content_id` = #{content_id} and a.`organize` = #{organize} and a.`category` = #{category}
    </select>


    <delete id="delete_by_name">
        delete from link_label where content_id = #{content_id} and label_id in
        <foreach collection="labels" item="item" open="(" close=")" separator=",">
            #{item}
        </foreach>
    </delete>

    <delete id="delete_by_content">
        delete `link_label` from `link_label` inner join `label` on label.`id` = link_label.`label_id`  where link_label.content_id = #{content_id} and label.`organize` = #{organize} and label.`category` = #{category}
    </delete>

    <select id="select_link_by_content">
        select group_concat(a.`label_id`) as `val` from `link_label` a where a.content_id = #{content} group by a.content_id
    </select>

    <select id="select_links_by_content">
        ` select `content_id` as `key`,group_concat(`label_id`) as `val` from `link_label` where `content_id` in `
        <foreach collection="content" item="item" open="(" close=")" separator=",">
            #{item}
        </foreach>
        ` group by `content_id` `
    </select>

</mapper>
